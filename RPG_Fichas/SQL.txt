CREATE TABLE Ficha (
    idFicha INT PRIMARY KEY IDENTITY(1,1),
    nomePersonagem VARCHAR(100) NOT NULL,
    nivel INT NOT NULL,
    classe VARCHAR(50) NOT NULL,
    raca VARCHAR(50) NOT NULL,
    antecedente VARCHAR(50),
    alinhamento VARCHAR(20),
    pontosVida INT NOT NULL,
    ca INT NOT NULL,
    deslocamento INT NOT NULL
);

CREATE TABLE Atributo (
    idAtributo INT PRIMARY KEY IDENTITY(1,1),
    nomeAtributo VARCHAR(50) NOT NULL
);

CREATE TABLE Ficha_Atributo (
    idFichaAtributo INT PRIMARY KEY IDENTITY(1,1),
    idFicha INT FOREIGN KEY REFERENCES Ficha(idFicha) ON DELETE CASCADE,
    idAtributo INT FOREIGN KEY REFERENCES Atributo(idAtributo) ON DELETE CASCADE,
    valor INT NOT NULL
);

CREATE TABLE Habilidade (
    idHabilidade INT PRIMARY KEY IDENTITY(1,1),
    nomeHabilidade VARCHAR(100) NOT NULL
);

CREATE TABLE Ficha_Habilidade (
    idFichaHabilidade INT PRIMARY KEY IDENTITY(1,1),
    idFicha INT FOREIGN KEY REFERENCES Ficha(idFicha) ON DELETE CASCADE,
    idHabilidade INT FOREIGN KEY REFERENCES Habilidade(idHabilidade) ON DELETE CASCADE,
    valor INT NOT NULL,
    proficiencia BIT NOT NULL
);

CREATE TABLE Equipamento (
    idEquipamento INT PRIMARY KEY IDENTITY(1,1),
    nomeEquipamento VARCHAR(100) NOT NULL,
    tipoEquipamento VARCHAR(50) NOT NULL
);

CREATE TABLE Ficha_Equipamento (
    idFichaEquipamento INT PRIMARY KEY IDENTITY(1,1),
    idFicha INT FOREIGN KEY REFERENCES Ficha(idFicha) ON DELETE CASCADE,
    idEquipamento INT FOREIGN KEY REFERENCES Equipamento(idEquipamento) ON DELETE CASCADE,
    quantidade INT NOT NULL
);

CREATE TABLE Magia (
    idMagia INT PRIMARY KEY IDENTITY(1,1),
    nomeMagia VARCHAR(100) NOT NULL,
);

CREATE TABLE Ficha_Magia (
    idFichaMagia INT PRIMARY KEY IDENTITY(1,1),
    idFicha INT FOREIGN KEY REFERENCES Ficha(idFicha) ON DELETE CASCADE,
    idMagia INT FOREIGN KEY REFERENCES Magia(idMagia) ON DELETE CASCADE,
    dano VARCHAR(10) NOT NULL
);

CREATE TABLE Usuario (
    idUsuario INT PRIMARY KEY IDENTITY(1,1),
    nomeUsuario VARCHAR(100) NOT NULL
);

ALTER TABLE Ficha
ADD idUsuario INT;

ALTER TABLE Ficha
ADD CONSTRAINT FK_Ficha_Usuario FOREIGN KEY (idUsuario)
REFERENCES Usuario(idUsuario)
ON DELETE SET NULL; 